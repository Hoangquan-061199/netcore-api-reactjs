function RoxyUtils(){}function RoxyFilemanConf(){}function RoxyLang(){}function t(n){var t=n;return RoxyLang&&RoxyLang[n]&&(t=RoxyLang[n]),t}function File(n,i,r,u,f){this.fullPath=n;this.type=RoxyUtils.GetFileType(n);this.name=RoxyUtils.GetFilename(n);this.ext=RoxyUtils.GetFileExt(n);this.path=RoxyUtils.GetPath(n);this.icon=RoxyUtils.GetFileIcon(n);this.bigIcon=this.icon.replace("filetypes","filetypes/big");this.image=n;this.size=i?i:RoxyUtils.GetFileSize(n);this.time=r;this.width=u?u:0;this.height=f?f:0;this.Show=function(){html='<li data-path="'+this.fullPath+'" data-time="'+this.time+'" data-icon="'+this.icon+'" data-w="'+this.width+'" data-h="'+this.height+'" data-size="'+this.size+'" data-icon-big="'+(this.IsImage()?this.fullPath:this.bigIcon)+'" title="'+this.name+'">';html+='<img src="'+this.icon+'" class="icon">';html+='<span class="time">'+RoxyUtils.FormatDate(new Date(this.time*1e3))+"<\/span>";html+='<span class="name">'+this.name+"<\/span>";html+='<span class="size">'+RoxyUtils.FormatFileSize(this.size)+"<\/span>";html+="<\/li>";$("#pnlFileList").append(html);var n=$("#pnlFileList li:last");RoxyFilemanConf.MOVEFILE&&n.draggable({helper:makeDragFile,start:startDragFile,cursorAt:{left:10,top:10},delay:200});let t=!1,i=!1;$(document).keydown(function(n){n.keyCode==17&&(t=!0);n.keyCode==16&&(i=!0)});$(document).keyup(function(){t=!1;i=!1});n.click(function(n){if(n.type=="click")if(t||i){if(t)selectFileAll(this);else if(i){let n=$("#pnlFileList").find("li.selected").index();if(n<$(this).index())for(let t=n;t<=$(this).index();t++)$($("#pnlFileList li")[t]).removeClass("selected"),selectFileAll($("#pnlFileList li")[t]);else for(let t=$(this).index();t<=n;t++)$($("#pnlFileList li")[t]).removeClass("selected"),selectFileAll($("#pnlFileList li")[t])}}else selectOnlyFile(this)});n.dblclick(function(){selectFile(this);setFile()});n.tooltip({show:{delay:700},track:!0,content:tooltipContent});n.bind("contextmenu",function(n){n.stopPropagation();n.preventDefault();closeMenus("dir");selectFile(this);$(this).tooltip("close");var t=n.pageY-$("#menuFile").height();return t<0&&(t=0),$("#menuFile").css({top:t+"px",left:n.pageX+"px"}).show(),!1})};this.GetElement=function(){return $('li[data-path="'+this.fullPath+'"]')};this.IsImage=function(){var n=!1;return this.type=="image"&&(n=!0),n};this.Delete=function(){if(!RoxyFilemanConf.DELETEFILE){alert(t("E_ActionDisabled"));return}var n=RoxyUtils.AddParam(RoxyFilemanConf.DELETEFILE,"f",this.fullPath),i=this;$.ajax({url:n,type:"POST",data:{f:this.fullPath},dataType:"json","async":!1,success:function(n){if(n.res.toLowerCase()=="ok"){$('li[data-path="'+i.fullPath+'"]').remove();var t=Directory.Parse(i.path);t&&(t.files--,t.Update(),t.SetStatusBar())}else alert(n.msg)},error:function(){alert(t("E_LoadingAjax")+" "+n)}})};this.Rename=function(n){var i,r,u;return RoxyFilemanConf.RENAMEFILE?n?(i=RoxyUtils.AddParam(RoxyFilemanConf.RENAMEFILE,"f",this.fullPath),i=RoxyUtils.AddParam(i,"n",n),r=this,u=!1,$.ajax({url:i,type:"POST",data:{f:this.fullPath,n:n},dataType:"json","async":!1,success:function(t){if(t.res.toLowerCase()=="ok"){var i=RoxyUtils.MakePath(this.path,n);$('li[data-path="'+r.fullPath+'"] .icon').attr("src",RoxyUtils.GetFileIcon(n));$('li[data-path="'+r.fullPath+'"] .name').text(n);$('li[data-path="'+i+'"]').attr("data-path",i);u=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+i)}}),u):!1:(alert(t("E_ActionDisabled")),!1)};this.Copy=function(n){var i,u,r;if(!RoxyFilemanConf.COPYFILE){alert(t("E_ActionDisabled"));return}return i=RoxyUtils.AddParam(RoxyFilemanConf.COPYFILE,"f",this.fullPath),i=RoxyUtils.AddParam(i,"n",n),u=this,r=!1,$.ajax({url:i,type:"POST",data:{f:this.fullPath,n:n},dataType:"json","async":!1,success:function(t){if(t.res.toLowerCase()=="ok"){var i=Directory.Parse(n);i&&(i.files++,i.Update(),i.SetStatusBar(),i.ListFiles(!0));r=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+i)}}),r};this.Move=function(n){var i,r,u;if(!RoxyFilemanConf.MOVEFILE){alert(t("E_ActionDisabled"));return}return newFullPath=RoxyUtils.MakePath(n,this.name),i=RoxyUtils.AddParam(RoxyFilemanConf.MOVEFILE,"f",this.fullPath),i=RoxyUtils.AddParam(i,"n",newFullPath),r=this,u=!1,$.ajax({url:i,type:"POST",data:{f:this.fullPath,n:newFullPath},dataType:"json","async":!1,success:function(t){if(t.res.toLowerCase()=="ok"){$('li[data-path="'+r.fullPath+'"]').remove();var i=Directory.Parse(r.path);i&&(i.files--,i.Update(),i.SetStatusBar(),i=Directory.Parse(n),i.files++,i.Update());u=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+i)}}),u}}function Directory(n,r,u){n||(n="");this.fullPath=n;this.name=RoxyUtils.GetFilename(n);this.name||(this.name="My files");this.path=RoxyUtils.GetPath(n);this.dirs=r?r:0;this.files=u?u:0;this.filesList=[];this.Show=function(){var t=this.GetHtml(),n=null;n=$('li[data-path="'+this.path+'"]');n.length==0?n=$("#pnlDirList"):(n.children("ul").length==0&&n.append("<ul><\/ul>"),n=n.children("ul"));n&&(n.append(t),this.SetEvents())};this.SetEvents=function(){var n=this.GetElement();RoxyFilemanConf.MOVEDIR&&n.draggable({helper:makeDragDir,start:startDragDir,cursorAt:{left:10,top:10},delay:200});n=n.children("div");n.click(function(){selectDir(this)});n.bind("contextmenu",function(n){n.stopPropagation();n.preventDefault();closeMenus("file");selectDir(this);var t=n.pageY-$("#menuDir").height();return t<0&&(t=0),$("#menuDir").css({top:t+"px",left:n.pageX+"px"}).show(),!1});n.droppable({drop:moveObject,over:dragFileOver,out:dragFileOut});n=n.children(".dirPlus");n.click(function(n){n.stopPropagation();var t=Directory.Parse($(this).closest("li").attr("data-path"));t.Expand()})};this.GetHtml=function(){var n='<li data-path="'+this.fullPath+'" data-dirs="'+this.dirs+'" data-files="'+this.files+'" class="directory">';return n+='<div><img src="images/'+(this.dirs>0?"/icon/plus.png":"blank.gif")+'" class="dirPlus" width="15" height="15">',n+='<img src="'+(this.files==0?"images/icon/folder.png":"images/icon/folder-full.png")+'" class="dir"><span class="name">'+this.name+" ("+this.files+")<\/span><\/div>",n+"<\/li>"};this.SetStatusBar=function(){$("#pnlStatus").html(this.files+" "+(this.files==1?t("file"):t("files")))};this.SetSelectedFile=function(n){if(n){var t=File.Parse(n);t&&selectFile(t.GetElement())}};this.Select=function(n){var i=this.GetElement(),t;for(i.children("div").addClass("selected"),$('#pnlDirList li[data-path!="'+this.fullPath+'"] > div').removeClass("selected"),i.children("img.dir").prop("src","images/icon/folder.png"),this.SetStatusBar(),t=this.GetParent();t;)t.Expand(!0),t=t.GetParent();this.Expand(!0);this.ListFiles(!0,n);setLastDir(this.fullPath)};this.GetElement=function(){return $('li[data-path="'+this.fullPath+'"]')};this.IsExpanded=function(){var n=this.GetElement().children("ul");return n&&n.is(":visible")};this.IsListed=function(){return $("#hdDir").val()==this.fullPath?!0:!1};this.GetExpanded=function(n){var t=[];return n||(n=$("#pnlDirList")),n.children("li").each(function(){var i=$(this).attr("data-path"),n=new Directory(i);n&&(n.IsExpanded()&&i&&t.push(i),t=t.concat(n.GetExpanded(n.GetElement().children("ul"))))}),t};this.RestoreExpanded=function(n){for(i=0;i<n.length;i++){var t=Directory.Parse(n[i]);t&&t.Expand(!0)}};this.GetParent=function(){return Directory.Parse(this.path)};this.SetOpened=function(){var n=this.GetElement();n.find("li").length<1?n.children("div").children(".dirPlus").prop("src","images/blank.gif"):this.IsExpanded()?n.children("div").children(".dirPlus").prop("src","images/icon/minus.png"):n.children("div").children(".dirPlus").prop("src","images/icon/plus.png")};this.Update=function(n){var t=this.GetElement();n&&(this.fullPath=n,this.name=RoxyUtils.GetFilename(n),this.name||(this.name="My files"),this.path=RoxyUtils.GetPath(n));t.attr("data-path",this.fullPath);t.attr("data-dirs",this.dirs);t.attr("data-files",this.files);t.children("div").children(".name").html(this.name+" ("+this.files+")");this.SetOpened()};this.LoadAll=function(n){var f=this.GetExpanded(),r=RoxyFilemanConf.DIRLIST,u;if(!r){alert(t("E_ActionDisabled"));return}$("#pnlLoadingDirs").show();$("#pnlDirList").hide();r=RoxyUtils.AddParam(r,"type",RoxyUtils.GetUrlParam("type"));u=this;$.ajax({url:r,type:"POST",dataType:"json","async":!1,cache:!1,success:function(t){var r;for($("#pnlDirList").children("li").remove(),i=0;i<t.length;i++)r=new Directory(t[i].p,t[i].d,t[i].f),r.Show();$("#pnlLoadingDirs").hide();$("#pnlDirList").show();u.RestoreExpanded(f);r=Directory.Parse(n);r&&r.Select()},error:function(){$("#pnlLoadingDirs").hide();$("#pnlDirList").show();alert(t("E_LoadingAjax")+" "+RoxyFilemanConf.DIRLIST)}})};this.Expand=function(n){var i=this.GetElement(),t=i.children("ul");this.IsExpanded()&&!n?t.hide():t.show();this.SetOpened()};this.Create=function(n){var i,r,u;if(n){if(!RoxyFilemanConf.CREATEDIR){alert(t("E_ActionDisabled"));return}}else return!1;return i=RoxyUtils.AddParam(RoxyFilemanConf.CREATEDIR,"d",this.fullPath),i=RoxyUtils.AddParam(i,"n",n),r=this,u=!1,$.ajax({url:i,type:"POST",data:{d:this.fullPath,n:n},dataType:"json","async":!1,cache:!1,success:function(t){t.res.toLowerCase()=="ok"?(r.LoadAll(RoxyUtils.MakePath(r.fullPath,n)),u=!0):alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+r.name)}}),u};this.Delete=function(){if(!RoxyFilemanConf.DELETEDIR){alert(t("E_ActionDisabled"));return}var r=RoxyUtils.AddParam(RoxyFilemanConf.DELETEDIR,"d",this.fullPath),n=this,i=!1;return $.ajax({url:r,type:"POST",data:{d:this.fullPath},dataType:"json","async":!1,cache:!1,success:function(t){if(t.res.toLowerCase()=="ok"){var r=n.GetParent();r.dirs--;r.Update();r.Select();n.GetElement().remove();i=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+n.name)}}),i};this.Rename=function(n){var r,i,u;if(n){if(!RoxyFilemanConf.RENAMEDIR){alert(t("E_ActionDisabled"));return}}else return!1;return r=RoxyUtils.AddParam(RoxyFilemanConf.RENAMEDIR,"d",this.fullPath),r=RoxyUtils.AddParam(r,"n",n),i=this,u=!1,$.ajax({url:r,type:"POST",data:{d:this.fullPath,n:n},dataType:"json","async":!1,cache:!1,success:function(t){if(t.res.toLowerCase()=="ok"){var r=RoxyUtils.MakePath(i.path,n);i.Update(r);i.Select();u=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+i.name)}}),u};this.Copy=function(n){var i,u,r;if(!RoxyFilemanConf.COPYDIR){alert(t("E_ActionDisabled"));return}return i=RoxyUtils.AddParam(RoxyFilemanConf.COPYDIR,"d",this.fullPath),i=RoxyUtils.AddParam(i,"n",n),u=this,r=!1,$.ajax({url:i,type:"POST",data:{d:this.fullPath,n:n},dataType:"json","async":!1,cache:!1,success:function(t){if(t.res.toLowerCase()=="ok"){var i=Directory.Parse(n);i&&i.LoadAll(i.fullPath);r=!0}t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+i)}}),r};this.Move=function(n){var i,r,u;if(n){if(!RoxyFilemanConf.MOVEDIR){alert(t("E_ActionDisabled"));return}}else return!1;return i=RoxyUtils.AddParam(RoxyFilemanConf.MOVEDIR,"d",this.fullPath),i=RoxyUtils.AddParam(i,"n",n),r=this,u=!1,$.ajax({url:i,type:"POST",data:{d:this.fullPath,n:n},dataType:"json","async":!1,cache:!1,success:function(t){t.res.toLowerCase()=="ok"&&(r.LoadAll(RoxyUtils.MakePath(n,r.name)),u=!0);t.msg&&alert(t.msg)},error:function(){alert(t("E_LoadingAjax")+" "+r.name)}}),u};this.ListFiles=function(n,t){$("#pnlLoading").show();$("#pnlEmptyDir").hide();$("#pnlFileList").hide();$("#pnlSearchNoFiles").hide();this.LoadFiles(n,t)};this.FilesLoaded=function(n,t){for(n=this.SortFiles(n),$("#pnlFileList").html(""),i=0;i<n.length;i++){var r=n[i];r.Show()}$("#hdDir").val(this.fullPath);$("#pnlLoading").hide();$("#pnlFileList").children("li").length==0&&$("#pnlEmptyDir").show();this.files=$("#pnlFileList").children("li").length;this.Update();this.SetStatusBar();filterFiles();switchView();$("#pnlFileList").show();this.SetSelectedFile(t)};this.LoadFiles=function(n,r){var f,u,e;if(!RoxyFilemanConf.FILESLIST){alert(t("E_ActionDisabled"));return}return f=[],u=RoxyFilemanConf.FILESLIST,u=RoxyUtils.AddParam(u,"d",this.fullPath),u=RoxyUtils.AddParam(u,"type",RoxyUtils.GetUrlParam("type")),e=this,!this.IsListed()||n?$.ajax({url:u,type:"POST",data:{d:this.fullPath,type:RoxyUtils.GetUrlParam("type")},dataType:"json","async":!0,cache:!1,success:function(n){for(i=0;i<n.length;i++)f.push(new File(n[i].p,n[i].s,n[i].t,n[i].w,n[i].h));e.FilesLoaded(f,r)},error:function(){alert(t("E_LoadingAjax")+" "+u)}}):($("#pnlFileList li").each(function(){f.push(new File($(this).attr("data-path"),$(this).attr("data-size"),$(this).attr("data-time"),$(this).attr("data-w"),$(this).attr("data-h")))}),e.FilesLoaded(f,r)),f};this.SortByName=function(n,t){return n.sort(function(n,i){var r=t=="desc"?0:2;return n=n.name.toLowerCase(),i=i.name.toLowerCase(),n>i?-1+r:n<i?1-r:0}),n};this.SortBySize=function(n,t){return n.sort(function(n,i){var r=t=="desc"?0:2;return n=parseInt(n.size),i=parseInt(i.size),n>i?-1+r:n<i?1-r:0}),n};this.SortByTime=function(n,t){return n.sort(function(n,i){var r=t=="desc"?0:2;return n=parseInt(n.time),i=parseInt(i.time),n>i?-1+r:n<i?1-r:0}),n};this.SortFiles=function(n){var t=$("#ddlOrder").val();t||(t="name");switch(t){case"size":n=this.SortBySize(n,"asc");break;case"size_desc":n=this.SortBySize(n,"desc");break;case"time":n=this.SortByTime(n,"asc");break;case"time_desc":n=this.SortByTime(n,"desc");break;case"name_desc":n=this.SortByName(n,"desc");break;default:n=this.SortByName(n,"asc")}return n}}function selectFile(n){$(n).prop("class","selected");var i=RoxyUtils.GetFilename($(n).attr("data-path"));i+=" ("+t("Size")+": "+RoxyUtils.FormatFileSize($(n).attr("data-size"));$(n).attr("data-w")>0&&(i+=", "+t("Dimensions")+":"+$(n).attr("data-w")+"x"+$(n).attr("data-h"));i+=")";$("#pnlStatus").html(i)}function selectOnlyFile(n){$("#pnlFileList").find("li").each(function(){$(this).hasClass("selected")&&$(this).removeClass("selected")});$(n).not($(this)).removeClass("selected");$(n).prop("class","selected");var i=RoxyUtils.GetFilename($(n).attr("data-path"));i+=" ("+t("Size")+": "+RoxyUtils.FormatFileSize($(n).attr("data-size"));$(n).attr("data-w")>0&&(i+=", "+t("Dimensions")+":"+$(n).attr("data-w")+"x"+$(n).attr("data-h"));i+=")";$("#pnlStatus").html(i)}function selectFileAll(n){if($(n).hasClass("selected"))$(n).removeClass("selected");else{$(n).prop("class","selected");var i=RoxyUtils.GetFilename($(n).attr("data-path"));i+=" ("+t("Size")+": "+RoxyUtils.FormatFileSize($(n).attr("data-size"));$(n).attr("data-w")>0&&(i+=", "+t("Dimensions")+":"+$(n).attr("data-w")+"x"+$(n).attr("data-h"));i+=")";$("#pnlStatus").html(i)}}function getLastDir(){return RoxyUtils.GetCookie("roxyld")}function setLastDir(n){RoxyUtils.SetCookie("roxyld",n,10)}function selectDir(n){var t=Directory.Parse($(n).parent("li").attr("data-path"));t&&t.Select()}function startDragDir(){}function startDragFile(){selectFile(this)}function dragFileOver(){$(this).children("img.dir").attr("src","images/folder-green.png")}function dragFileOut(){$("#pnlDirList").find("img.dir").attr("src","images/folder.png")}function makeDragFile(n){var t=new File($(n.target).closest("li").attr("data-path"));return'<div class="pnlDragFile" data-path="'+t.fullPath+'"><img src="'+t.bigIcon+'" align="absmiddle">&nbsp;'+t.name+"<\/div>"}function makeDragDir(n){var t=new Directory($(n.target).attr("data-path")?$(n.target).attr("data-path"):$(n.target).closest("li").attr("data-path"));return'<div class="pnlDragDir" data-path="'+t.fullPath+'"><img src="images/folder.png" align="absmiddle">&nbsp;'+t.name+"<\/div>"}function moveDir(n,t,i){var r=Directory.Parse(t.draggable.attr("data-path")),u=Directory.Parse($(i).parent("li").attr("data-path"));u.fullPath!=r.path&&r.Move(u.fullPath)}function moveFile(n,t,i){var r=new File(t.draggable.attr("data-path")),u=Directory.Parse($(i).parent("li").attr("data-path")),f=Directory.Parse(r.path);r.path!=u.fullPath&&r.Move(u.fullPath)}function moveObject(n,t){n.stopPropagation();t.draggable.hasClass("directory")?moveDir(n,t,this):moveFile(n,t,this);dragFileOut()}function clickFirstOnEnter(n){$("#"+n).unbind("keypress");$(".actions input").each(function(){this.blur()});$("#"+n).keypress(function(n){n.keyCode==$.ui.keyCode.ENTER&&(n.stopPropagation(),$(this).parent().find(".ui-dialog-buttonset button").eq(0).trigger("click"))})}function addDir(){var i=getSelectedDir(),n;i&&(clickFirstOnEnter("pnlDirName"),$("#txtDirName").val(""),n={},n[t("CreateDir")]=function(){var n=$.trim($("#txtDirName").val());n||alert(t("E_MissingDirName"));i.Create(n)&&$("#pnlDirName").dialog("close")},n[t("Cancel")]=function(){$("#pnlDirName").dialog("close")},$("#pnlDirName").dialog({title:t("T_CreateDir"),modal:!0,buttons:n}))}function showUploadList(n){var t=$("#uploadFilesList");for(t.html(""),clearFileField(),i=0;i<n.length;i++)t.append('<div class="fileUpload"><div class="fileName">'+n[i].name+" ("+RoxyUtils.FormatFileSize(n[i].size)+')<span class="progressPercent"><\/span><div class="uploadProgress"><div class="stripes"><\/div><\/div><\/div><a class="removeUpload" onclick="removeUpload('+i+')"><\/a><\/div>');n.length>0?$("#btnUpload").button("enable"):$("#btnUpload").button("disable")}function listUploadFiles(n){window.FileList?n.length>0&&(uploadFileList=[],addUploadFiles(n)):$("#btnUpload").button("enable")}function addUploadFiles(n){for(i=0;i<n.length;i++)uploadFileList.push(n[i]);showUploadList(uploadFileList)}function removeUpload(n){var t=findUploadElement(n);t.remove();try{uploadFileList.splice(n,1);showUploadList(uploadFileList)}catch(i){}}function findUploadElement(n){return $("#uploadFilesList .fileUpload:eq("+n+")")}function updateUploadProgress(n,t){var r=findUploadElement(t),i=99;n.lengthComputable&&(i=Math.floor(n.loaded/n.total*100));i>99&&(i=99);r.find(".uploadProgress").css("width",i+"%");r.find(".progressPercent").html(" - "+i+"%")}function uploadComplete(n,t){uploadFinished(n,t,"ok")}function uploadError(n,t){setUploadError(t);uploadFinished(n,t,"error")}function setUploadError(n){var i=findUploadElement(n);i.find(".uploadProgress").css("width","100%").addClass("uploadError").removeClass("uploadComplete");i.find(".progressPercent").html(' - <span class="error">'+t("E_UploadingFile")+"<\/span>")}function setUploadSuccess(n){var t=findUploadElement(n);t.find(".uploadProgress").css("width","100%").removeClass("uploadError").addClass("uploadComplete");t.find(".progressPercent").html(" - 100%")}function uploadCanceled(n,t){uploadFinished(n,t,"error")}function uploadFinished(n,t,i){var u=findUploadElement(t),r=null;try{r=JSON.parse(n.target.responseText)}catch(f){}r&&r.res=="error"||i!="ok"?(i="error",setUploadError(t)):(i="ok",setUploadSuccess(t));u.attr("data-ulpoad",i);checkUploadResult()}function checkUploadResult(){var t=$("#uploadFilesList .fileUpload").length,i=$("#uploadFilesList .fileUpload[data-ulpoad]").length,r=$('#uploadFilesList .fileUpload[data-ulpoad="ok"]').length,n;i==t&&(uploadFileList=[],n=Directory.Parse($("#hdDir").val()),n.ListFiles(!0),$("#btnUpload").button("disable"))}function fileUpload(n,t){var i=new XMLHttpRequest,r=new FormData,u=findUploadElement(t);u.find(".removeUpload").remove();r.append("action","upload");r.append("method","ajax");r.append("d",$("#hdDir").attr("value"));r.append("files[]",n);i.upload.addEventListener("progress",function(n){updateUploadProgress(n,t)},!1);i.addEventListener("load",function(n){uploadComplete(n,t)},!1);i.addEventListener("error",function(n){uploadError(n,t)},!1);i.addEventListener("abort",function(n){uploadCanceled(n,t)},!1);i.open("POST",RoxyFilemanConf.UPLOAD,!0);i.setRequestHeader("Accept","*/*");i.send(r)}function dropFiles(n,t){n&&n.dataTransfer&&n.dataTransfer.files?(addFile(),t?addUploadFiles(n.dataTransfer.files):listUploadFiles(n.dataTransfer.files)):addFile()}function clearFileField(n){n||(n="#fileUploads");try{$(n).val("");$(n).val(null)}catch(t){}}function addFileClick(){$("#uploadResult").html("");showUploadList([]);addFile()}function setAllFile(){let n;$("#pnlFileList").find("li").each(function(){$(this).hasClass("selected")||$(this).addClass("selected");$(this).prop("class","selected");n=RoxyUtils.GetFilename($(this).attr("data-path"));n+=" ("+t("Size")+": "+RoxyUtils.FormatFileSize($(this).attr("data-size"));$(this).attr("data-w")>0&&(n+=", "+t("Dimensions")+":"+$(this).attr("data-w")+"x"+$(this).attr("data-h"));n+=")";$("#pnlStatus").html(n)})}function unSetAllFile(){$("#pnlFileList").find("li").each(function(){$(this).hasClass("selected")&&$(this).removeClass("selected")})}function addFile(){clickFirstOnEnter("dlgAddFile");$("#uploadResult").html("");clearFileField();var n={};n[t("Upload")]={id:"btnUpload",text:t("Upload"),disabled:!0,click:function(){if($("#fileUploads").val()||uploadFileList&&uploadFileList.length!=0)if(RoxyFilemanConf.UPLOAD){if(window.FormData&&window.XMLHttpRequest&&window.FileList&&uploadFileList&&uploadFileList.length>0)for(i=0;i<uploadFileList.length;i++)fileUpload(uploadFileList[i],i);else document.forms.addfile.action=RoxyFilemanConf.UPLOAD,document.forms.addfile.submit();$("#dlgAddFile").dialog("close")}else alert(t("E_ActionDisabled"));else alert(t("E_SelectFiles"))}};n[t("Cancel")]=function(){$("#dlgAddFile").dialog("close")};$("#dlgAddFile").dialog({title:t("T_AddFile"),modal:!0,buttons:n,width:400})}function fileUploaded(n){var t;n.res=="ok"&&n.msg?($("#dlgAddFile").dialog("close"),t=Directory.Parse($("#hdDir").val()),t.ListFiles(!0),alert(n.msg)):n.res=="ok"?($("#dlgAddFile").dialog("close"),t=Directory.Parse($("#hdDir").val()),t.ListFiles(!0)):alert(n.msg)}function renameDir(){var n=getSelectedDir(),i;if(n){if($('[data-path="'+n.fullPath+'"]').parents("li").length<1){alert(t("E_CannotRenameRoot"));return}clickFirstOnEnter("pnlDirName");$("#txtDirName").val(n.name);i={};i[t("RenameDir")]=function(){var i=$.trim($("#txtDirName").val());i||alert(t("E_MissingDirName"));n.Rename(i)&&$("#pnlDirName").dialog("close")};i[t("Cancel")]=function(){$("#pnlDirName").dialog("close")};$("#pnlDirName").dialog({title:t("T_RenameDir"),modal:!0,buttons:i});RoxyUtils.SelectText("txtDirName",0,new String(n.name).length)}}function renameFile(){var n=getSelectedFile(),i;n&&(clickFirstOnEnter("pnlRenameFile"),$("#txtFileName").val(n.name),i={},i[t("RenameFile")]=function(){var t=$.trim($("#txtFileName").val());t?n.Rename(t)&&($('li[data-path="'+n.fullPath+'"] .name').text(t),$('li[data-path="'+n.fullPath+'"]').attr("data-path",RoxyUtils.MakePath(n.path,t)),$("#pnlRenameFile").dialog("close")):alert("Missing file name")},i[t("Cancel")]=function(){$("#pnlRenameFile").dialog("close")},$("#pnlRenameFile").dialog({title:t("T_RenameFile"),modal:!0,buttons:i}),n.name.lastIndexOf(".")>0&&RoxyUtils.SelectText("txtFileName",0,n.name.lastIndexOf(".")))}function getSelectedFile(){var n=null;return $("#pnlFileList .selected").length>0&&(n=new File($("#pnlFileList .selected").attr("data-path"))),n}function getSelectedDir(){var n=null;return $("#pnlDirList .selected")&&(n=Directory.Parse($("#pnlDirList .selected").closest("li").attr("data-path"))),n}function deleteDir(n){var i=null;i=n?Directory.Parse(n):getSelectedDir();i&&confirm(t("Q_DeleteFolder"))&&i.Delete()}function deleteFile(){var n,i,r;if(confirm(t("Q_DeleteFile"))&&(n=[],$("#pnlFileList .selected").each(function(){n.push($(this).attr("data-path"))}),n.length>0))for(i=0;i<n.length;i++)r=new File(n[i]),r.Delete()}function previewFile(){var n=getSelectedFile();n&&window.open(n.fullPath)}function downloadFile(){var n=getSelectedFile(),i;n&&RoxyFilemanConf.DOWNLOAD?(i=RoxyUtils.AddParam(RoxyFilemanConf.DOWNLOAD,"f",n.fullPath),window.frames.frmUploadFile.location.href=i):RoxyFilemanConf.DOWNLOAD||alert(t("E_ActionDisabled"))}function downloadDir(){var n=getSelectedDir(),i;n&&RoxyFilemanConf.DOWNLOADDIR?(i=RoxyUtils.AddParam(RoxyFilemanConf.DOWNLOADDIR,"d",n.fullPath),window.frames.frmUploadFile.location.href=i):RoxyFilemanConf.DOWNLOAD||alert(t("E_ActionDisabled"))}function closeMenus(n){n&&n!="dir"||$("#menuDir").fadeOut();n&&n!="file"||$("#menuFile").fadeOut()}function selectFirst(){var n=$("#pnlDirList li:first").children("div").first();n.length>0?selectDir(n):window.setTimeout("selectFirst()",300)}function tooltipContent(){if($("#menuFile").is(":visible"))return"";var i="",n=File.Parse($(this).attr("data-path"));return $("#hdViewType").val()=="thumb"&&n.IsImage()?i=n.fullPath+'<br><span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+" "+t("Dimensions")+": "+n.width+"x"+n.height+"<\/span>":n.IsImage()?(RoxyFilemanConf.GENERATETHUMB?(imgUrl=RoxyUtils.AddParam(RoxyFilemanConf.GENERATETHUMB,"f",n.fullPath),imgUrl=RoxyUtils.AddParam(imgUrl,"width",RoxyFilemanConf.PREVIEW_THUMB_WIDTH),imgUrl=RoxyUtils.AddParam(imgUrl,"height",RoxyFilemanConf.PREVIEW_THUMB_HEIGHT)):imgUrl=n.fullPath,i='<img src="'+imgUrl+'" class="imgPreview"><br>'+n.name+' <br><span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+" "+t("Dimensions")+": "+n.width+"x"+n.height+"<\/span>"):i=n.fullPath+' <span class="filesize">'+t("Size")+": "+RoxyUtils.FormatFileSize(n.size)+"<\/span>",i}function filterFiles(){var t=$("#txtSearch").val(),n;if($("#pnlSearchNoFiles").hide(),$("#pnlFileList li").length!=0){if(!t){$("#pnlFileList li").show();return}n=0;$("#pnlFileList li").each(function(){var i=$(this).children(".name").text();i.toLowerCase().indexOf(t.toLowerCase())>-1?(n++,$(this).show()):($(this).removeClass("selected"),$(this).hide())});n==0&&$("#pnlSearchNoFiles").show()}}function sortFiles(){var n=getSelectedDir();n&&(n.ListFiles(),filterFiles(),switchView($("#hdViewType").val()))}function switchView(n){if(n!=$("#hdViewType").val()){if(n||(n=$("#hdViewType").val()),$(".btnView").removeClass("selected"),n=="thumb"){if($("#pnlFileList .icon").attr("src","images/blank.gif"),$("#pnlFileList").addClass("thumbView"),$("#dynStyle").length==0){$("head").append('<style id="dynStyle" />');var t="ul#pnlFileList.thumbView li{width:"+RoxyFilemanConf.THUMBS_VIEW_WIDTH+"px;}";t+="ul#pnlFileList.thumbView li{height:"+(parseInt(RoxyFilemanConf.THUMBS_VIEW_HEIGHT)+20)+"px;}";t+="ul#pnlFileList.thumbView .icon{width:"+RoxyFilemanConf.THUMBS_VIEW_WIDTH+"px;}";t+="ul#pnlFileList.thumbView .icon{height:"+RoxyFilemanConf.THUMBS_VIEW_HEIGHT+"px;}";$("#dynStyle").html(t)}$("#pnlFileList li").each(function(){var n=$(this).attr("data-icon-big");RoxyFilemanConf.GENERATETHUMB&&RoxyUtils.IsImage($(this).attr("data-path"))&&(n=RoxyUtils.AddParam(RoxyFilemanConf.GENERATETHUMB,"f",n),n=RoxyUtils.AddParam(n,"width",RoxyFilemanConf.THUMBS_VIEW_WIDTH),n=RoxyUtils.AddParam(n,"height",RoxyFilemanConf.THUMBS_VIEW_HEIGHT));$(this).children(".icon").css("background-image","url("+n+")");$(this).tooltip("option","show",{delay:50})});$("#btnThumbView").addClass("selected")}else $("#pnlFileList").removeClass("thumbView"),$("#pnlFileList li").each(function(){$(this).children(".icon").css("background-image","").attr("src",$(this).attr("data-icon"));$(this).tooltip("option","show",{delay:500})}),$("#btnListView").addClass("selected");$("#hdViewType").val(n);RoxyUtils.SetCookie("roxyview",n,10)}}function Clipboard(n,t){this.action=n;this.obj=t}function cutDir(){var n=getSelectedDir();n&&(setClipboard("cut",n),n.GetElement().addClass("pale"))}function copyDir(){var n=getSelectedDir();n&&setClipboard("copy",n)}function cutFile(){var n=getSelectedFile();n&&(setClipboard("cut",n),n.GetElement().addClass("pale"))}function copyFile(){var n=getSelectedFile();n&&setClipboard("copy",n)}function pasteToFiles(n,t){if($(t).hasClass("pale"))return n.stopPropagation(),!1;var i=getSelectedDir();return i||(i=Directory.Parse($("#pnlDirList li:first").children("div").first())),i&&clipBoard&&clipBoard.obj&&(clipBoard.action=="copy"?clipBoard.obj.Copy(i.fullPath):(clipBoard.obj.Move(i.fullPath),clearClipboard())),!0}function pasteToDirs(n,t){if($(t).hasClass("pale"))return n.stopPropagation(),!1;var i=getSelectedDir();return i||(i=Directory.Parse($("#pnlDirList li:first").children("div").first())),clipBoard&&i?clipBoard.action=="copy"?clipBoard.obj.Copy(i.fullPath):(clipBoard.obj.Move(i.fullPath),clearClipboard(),i.ListFiles(!0)):alert("error"),!0}function clearClipboard(){$("#pnlDirList li").removeClass("pale");$("#pnlFileList li").removeClass("pale");clipBoard=null;$(".paste").addClass("pale")}function setClipboard(n,t){clearClipboard();t&&(clipBoard=new Clipboard(n,t),$(".paste").removeClass("pale"))}function ResizeLists(){let n=$(window).innerHeight()-$("#fileActions .actions").outerHeight()-$(".bottomLine").outerHeight()-15;$(".scrollPane").css("height",n)}function removeDisabledActions(){RoxyFilemanConf.CREATEDIR==""&&($("#mnuCreateDir").next().remove(),$("#mnuCreateDir").remove(),$("#btnAddDir").remove());RoxyFilemanConf.DELETEDIR==""&&($("#mnuDeleteDir").prev().remove(),$("#mnuDeleteDir").remove(),$("#btnDeleteDir").remove());RoxyFilemanConf.MOVEDIR==""&&($("#mnuDirCut").next().remove(),$("#mnuDirCut").remove());RoxyFilemanConf.COPYDIR==""&&($("#mnuDirCopy").next().remove(),$("#mnuDirCopy").remove());RoxyFilemanConf.COPYDIR==""&&RoxyFilemanConf.MOVEDIR==""&&($("#mnuDirPaste").next().remove(),$("#mnuDirPaste").remove());RoxyFilemanConf.RENAMEDIR==""&&($("#mnuRenameDir").next().remove(),$("#mnuRenameDir").remove(),$("#btnRenameDir").remove());RoxyFilemanConf.UPLOAD==""&&$("#btnAddFile").remove();RoxyFilemanConf.DOWNLOAD==""&&($("#mnuDownload").next().remove(),$("#mnuDownload").remove());RoxyFilemanConf.DOWNLOADDIR==""&&($("#mnuDownloadDir").next().remove(),$("#mnuDownloadDir").remove());RoxyFilemanConf.DELETEFILE==""&&($("#mnuDeleteFile").prev().remove(),$("#mnuDeleteFile").remove(),$("#btnDeleteFile").remove());RoxyFilemanConf.MOVEFILE==""&&($("#mnuFileCut").next().remove(),$("#mnuFileCut").remove());RoxyFilemanConf.COPYFILE==""&&($("#mnuFileCopy").next().remove(),$("#mnuFileCopy").remove());RoxyFilemanConf.COPYFILE==""&&RoxyFilemanConf.MOVEFILE==""&&($("#mnuFilePaste").next().remove(),$("#mnuFilePaste").remove());RoxyFilemanConf.RENAMEFILE==""&&($("#mnuRenameFile").next().remove(),$("#mnuRenameFile").remove(),$("#btnRenameFile").remove())}function getPreselectedFile(){var n=RoxyUtils.GetUrlParam("selected"),r,i,t;if(!n)switch(getFilemanIntegration()){case"ckeditor":try{r=window.opener.CKEDITOR.dialog.getCurrent();n=r.getValueOf("info",r.getName()=="link"?"url":"txtUrl")}catch(u){}break;case"tinymce3":try{i=tinyMCEPopup.getWindowArg("window");n=i.document.getElementById(tinyMCEPopup.getWindowArg("input")).value;n.indexOf("..")==0&&(n=n.substr(2))}catch(u){}break;case"tinymce4":try{i=window.opener?window.opener:window.parent;n=i.document.getElementById(RoxyUtils.GetUrlParam("input")).value;n.indexOf("..")==0&&(n=n.substr(2))}catch(u){}}return RoxyFilemanConf.RETURN_URL_PREFIX&&(t=RoxyFilemanConf.RETURN_URL_PREFIX,n.indexOf(t)==0&&(t.substr(-1)=="/"&&(t=t.substr(0,t.length-1)),n=n.substr(t.length))),n}function initSelection(n){var t=!1,r=!0,u,i;if(n||(n=getPreselectedFile()),!n&&RoxyUtils.ToBool(RoxyFilemanConf.OPEN_LAST_DIR)&&(n=getLastDir(),r=!1),n){u=r?RoxyUtils.GetPath(n):n;i=tmp=Directory.Parse(u);do tmp&&(tmp.Expand(!0),t=!0),tmp=Directory.Parse(tmp.path);while(tmp);i&&(i.Select(n),t=!0)}t||selectFirst()}function getFilemanIntegration(){var n=RoxyUtils.GetUrlParam("integration");return n||(n=RoxyFilemanConf.INTEGRATION),n.toLowerCase()}function setFile(){var u=[],f,e,i,r,n;if($("#pnlFileList .selected").each(function(){u.push($(this).attr("data-path"))}),u.length>0)for(f=0;f<u.length;f++){if(e=new File(u[f]),!e){alert(t("E_NoFileSelected"));return}i=e.fullPath;RoxyFilemanConf.RETURN_URL_PREFIX&&(r=RoxyFilemanConf.RETURN_URL_PREFIX,r.substr(-1)=="/"&&(r=r.substr(0,r.length-1)),i=r+(i.substr(0,1)!="/"?"/":"")+i);switch(getFilemanIntegration()){case"ckeditor":window.opener.CKEDITOR.tools.callFunction(RoxyUtils.GetUrlParam("CKEditorFuncNum"),i);self.close();break;case"tinymce3":n=tinyMCEPopup.getWindowArg("window");n.document.getElementById(tinyMCEPopup.getWindowArg("input")).value=i;typeof n.ImageDialog!="undefined"&&(n.ImageDialog.getImageData&&n.ImageDialog.getImageData(),n.ImageDialog.showPreviewImage&&n.ImageDialog.showPreviewImage(i));tinyMCEPopup.close();break;case"tinymce4":n=window.opener?window.opener:window.parent;n.document.getElementById(RoxyUtils.GetUrlParam("input")).value=i;typeof n.ImageDialog!="undefined"&&(n.ImageDialog.getImageData&&n.ImageDialog.getImageData(),n.ImageDialog.showPreviewImage&&n.ImageDialog.showPreviewImage(i));n.tinyMCE.activeEditor.windowManager.close();break;default:FileSelected(e)}}}var fileTypeIcons={},FileTypes,uploadFileList,clipBoard;fileTypeIcons["7z"]="icon-zip.png";fileTypeIcons.doc="file-doc.png";fileTypeIcons.docx="file-doc.png";fileTypeIcons.jpeg="file-img.png";fileTypeIcons.jpg="file-img.png";fileTypeIcons.pdf="file-pdf.png";fileTypeIcons.png="file-img.png";fileTypeIcons.webp="file-img.png";fileTypeIcons.rar="icon-zip.png";fileTypeIcons.torrent="file_extension_torrent.png";fileTypeIcons.xls="file-excel.png";fileTypeIcons.xlsx="file-excel.png";fileTypeIcons.ppt="file-ppt.png";fileTypeIcons.xpi="file_extension_xpi.png";fileTypeIcons.zip="icon-zip.png";FileTypes=[];FileTypes.image=["jpg","jpeg","png","gif"];FileTypes.media=["avi","flv","swf","wmv","mp3","mp4","wma","mpg","mpeg"];FileTypes.document=["doc","docx","txt","rtf","pdf","xls","mdb","html","htm","db"];RoxyUtils.FixPath=function(n){if(!n)return"";var t=n.replace(/\\/g,"");return t=t.replace(/\/\//g,"/"),t.replace(":/","://")};RoxyUtils.FormatDate=function(n){var t="";try{t=$.format.date(n,RoxyFilemanConf.DATEFORMAT)}catch(i){t=n.toString();t=t.substr(0,t.indexOf("UTC"))}return t};RoxyUtils.GetPath=function(n){var t="";return n=RoxyUtils.FixPath(n),n.indexOf("/")>-1&&(t=n.substring(0,n.lastIndexOf("/"))),t};RoxyUtils.GetUrlParam=function(n,t){var u="",r;if(t||(t=self.location.href),t.indexOf("?")>-1)for(t=t.substr(t.indexOf("?")+1),t=t.split("&"),i=0;i<t.length;i++)if(r=t[i].split("="),r[0]&&r[1]&&r[0]==n){u=r[1];break}return u};RoxyUtils.GetFilename=function(n){var t=n;return n=RoxyUtils.FixPath(n),n.indexOf("/")>-1&&(t=n.substring(n.lastIndexOf("/")+1)),t};RoxyUtils.MakePath=function(){if(ret="",arguments&&arguments.length>0){for(var n=0;n<arguments.length;n++)ret+=$.isArray(arguments[n])?arguments[n].join("/"):arguments[n],n<arguments.length-1&&(ret+="/");ret=RoxyUtils.FixPath(ret)}return ret};RoxyUtils.GetFileExt=function(n){var t="";return n=RoxyUtils.GetFilename(n),n.indexOf(".")>-1&&(t=n.substring(n.lastIndexOf(".")+1)),t};RoxyUtils.FileExists=function(n){var t=!1;return $.ajax({url:n,type:"HEAD","async":!1,dataType:"text",success:function(){t=!0}}),t};RoxyUtils.GetFileIcon=function(n){return ret="images/icon/file.png",fileTypeIcons[RoxyUtils.GetFileExt(n).toLowerCase()]&&(ret="images/icon/"+fileTypeIcons[RoxyUtils.GetFileExt(n).toLowerCase()]),ret};RoxyUtils.GetFileSize=function(n){var t=0;return $.ajax({url:n,type:"HEAD","async":!1,success:function(n,i,r){t=r.getResponseHeader("Content-Length")}}),t||(t=0),t};RoxyUtils.GetFileType=function(n){var t=RoxyUtils.GetFileExt(n).toLowerCase();return(t=="png"||t=="jpg"||t=="gif"||t=="jpeg"||t=="webp")&&(t="image"),t};RoxyUtils.IsImage=function(n){var t=!1;return RoxyUtils.GetFileType(n)=="image"&&(t=!0),t};RoxyUtils.FormatFileSize=function(n){var t="B";return n||(n=0),n>1024&&(n=n/1024,t="KB"),n>1024&&(n=n/1024,t="MB"),n=new Number(n),n.toFixed(2)+" "+t};RoxyUtils.AddParam=function(n,t,i){return n+((n.indexOf("?")>-1?"&":"?")+t+"="+encodeURIComponent(i))};RoxyUtils.SelectText=function(n,t,i){var r,u;try{r=document.getElementById(n);r.createTextRange?(u=r.createTextRange(),u.collapse(!0),u.moveStart("character",t),u.moveEnd("character",i-t),u.select()):r.setSelectionRange?r.setSelectionRange(t,i):r.selectionStart&&(r.selectionStart=t,r.selectionEnd=i);r.focus()}catch(f){}};RoxyUtils.LoadConfig=function(){$.ajax({url:"conf.json",dataType:"json","async":!1,success:function(n){RoxyFilemanConf=n},error:function(){alert(t("E_LoadingConf"))}})};RoxyUtils.LoadLang=function(){var n="",t;RoxyFilemanConf.LANG&&RoxyFilemanConf.LANG.toLowerCase()=="auto"?(RoxyUtils.GetUrlParam("langCode")?n="lang/"+RoxyUtils.GetUrlParam("langCode").substr(0,2).toLowerCase()+".json":(t=window.navigator.userLanguage||window.navigator.language,n="lang/"+t.substr(0,2)+".json"),RoxyUtils.FileExists(n)||(n="")):RoxyFilemanConf.LANG&&(n="lang/"+RoxyFilemanConf.LANG.substr(0,2).toLowerCase()+".json",RoxyUtils.FileExists(n)||(n=""));n||(n="lang/en.json");$.ajax({url:n,dataType:"json","async":!1,success:function(n){RoxyLang=n},error:function(){alert("Error loading language file")}})};RoxyUtils.Translate=function(){RoxyUtils.LoadLang();$("[data-lang-t]").each(function(){var n=$(this).attr("data-lang-t");$(this).prop("title",t(n))});$("[data-lang-v]").each(function(){var n=$(this).attr("data-lang-v");$(this).prop("value",t(n))});$("[data-lang]").each(function(){var n=$(this).attr("data-lang");$(this).html(t(n))})};RoxyUtils.GetCookies=function(){var r={},n=document.cookie.replace(" ",""),t;n=n.split(";");for(i in n)t=n[i].split("="),t.length>1&&(r[$.trim(t[0].toString())]=decodeURIComponent($.trim(t[1].toString()))||"");return r};RoxyUtils.GetCookie=function(n){var t=RoxyUtils.GetCookies();return t[n]||""};RoxyUtils.SetCookie=function(n,t,i,r){var u=new Date;i&&u.setTime(u.getTime()+i*36e5);r||(r="/");document.cookie=n+"="+encodeURIComponent(t)+"; path="+r+(i?"; expires="+u.toGMTString():"")};RoxyUtils.ToBool=function(n){var t=!1;return n=n.toString().toLowerCase(),(n=="true"||n=="on"||n=="yes"||n=="1")&&(t=!0),t};RoxyUtils.UnsetCookie=function(n){document.cookie=n+"=; expires=Thu, 01 Jan 1972 00:00:00 UTC"};File.Parse=function(n){var i=!1,t=$("#pnlFileList").find('li[data-path="'+n+'"]');return t.length>0&&(i=new File(t.attr("data-path"),t.attr("data-size"),t.attr("data-time"),t.attr("data-w"),t.attr("data-h"))),i};Directory.Parse=function(n){var i=!1,t=$("#pnlDirList").find('li[data-path="'+n+'"]');return t.length>0&&(i=new Directory(t.attr("data-path"),t.attr("data-dirs"),t.attr("data-files"))),i};$.ajaxSetup({cache:!1});uploadFileList=[];clipBoard=null;$(function(){var i,t,n;if(RoxyUtils.LoadConfig(),i=new Directory,i.LoadAll(),$("#wraper").show(),window.setTimeout("initSelection()",100),RoxyUtils.Translate(),$("body").click(function(){closeMenus()}),t=RoxyUtils.GetCookie("roxyview"),t||(t=RoxyFilemanConf.DEFAULTVIEW),t&&switchView(t),ResizeLists(),$(".actions input").tooltip({track:!0}),$(window).resize(ResizeLists),document.oncontextmenu=function(){return!1},removeDisabledActions(),$("#copyYear").html((new Date).getFullYear()),RoxyFilemanConf.UPLOAD&&RoxyFilemanConf.UPLOAD!=""&&(n=document.getElementById("fileActions"),n.ondragover=function(){return!1},n.ondragend=function(){return!1},n.ondrop=function(n){n.preventDefault();n.stopPropagation();dropFiles(n)},n=document.getElementById("dlgAddFile"),n.ondragover=function(){return!1},n.ondragend=function(){return!1},n.ondrop=function(n){n.preventDefault();n.stopPropagation();dropFiles(n,!0)}),getFilemanIntegration()=="tinymce3")try{$("body").append('<script src="js/tiny_mce_popup.js"><\/script>')}catch(r){}});